!function(t,e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("undefined"!=typeof exports)e(require("jquery"));else{e(t.jQuery),t.jqueryAsRangeEs={}}}(this,function(t){"use strict";var e,p=(e=t)&&e.__esModule?e:{default:e};var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t};function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var r={namespace:"asRange",skin:null,max:100,min:0,value:null,step:10,limit:!0,range:!1,direction:"h",keyboard:!0,replaceFirst:!1,tip:!0,scale:!0,format:function(t){return t}};function u(t){var e=t.originalEvent;return e.touches&&e.touches.length&&e.touches[0]&&(e=e.touches[0]),e}var n=(i(l,[{key:"mousedown",value:function(t){var s=this.parent.direction.axis,e=this.parent.direction.position,i=this.parent.$wrap.offset();this.$element.trigger(this.parent.namespace+"::moveStart",this),this.data={},this.data.start=t[s],this.data.position=t[s]-i[e];var n=this.parent.getValueFromPosition(this.data.position);return this.set(n),p.default.each(this.parent.pointer,function(t,e){e.deactive()}),this.active(),this.mousemove=function(t){var e=u(t),i=this.parent.getValueFromPosition(this.data.position+(e[s]||this.data.start)-this.data.start);return this.set(i),t.preventDefault(),!1},this.mouseup=function(){return(0,p.default)(document).off(".asRange mousemove.asRange touchend.asRange mouseup.asRange touchcancel.asRange"),this.$element.trigger(this.parent.namespace+"::moveEnd",this),!1},(0,p.default)(document).on("touchmove.asRange mousemove.asRange",p.default.proxy(this.mousemove,this)).on("touchend.asRange mouseup.asRange",p.default.proxy(this.mouseup,this)),!1}},{key:"active",value:function(){this.$element.addClass(this.classes.active)}},{key:"deactive",value:function(){this.$element.removeClass(this.classes.active)}},{key:"set",value:function(t){this.value!==t&&(this.parent.step&&(t=this.matchStep(t)),!0===this.options.limit?t=this.matchLimit(t):(t<=this.parent.min&&(t=this.parent.min),t>=this.parent.max&&(t=this.parent.max)),this.value=t,this.updatePosition(),this.$element.focus(),this.$element.trigger(this.parent.namespace+"::move",this))}},{key:"updatePosition",value:function(){var t={};t[this.parent.direction.position]=this.getPercent()+"%",this.$element.css(t)}},{key:"getPercent",value:function(){return(this.value-this.parent.min)/this.parent.interval*100}},{key:"get",value:function(){return this.value}},{key:"matchStep",value:function(t){var e=this.parent.step,i=e.toString().split(".")[1];return t=Math.round(t/e)*e,i&&(t=t.toFixed(i.length)),parseFloat(t)}},{key:"matchLimit",value:function(t){var e=void 0,i=void 0,s=this.parent.pointer;return t<=(e=1===this.uid?this.parent.min:s[this.uid-2].value)&&(t=e),(i=s[this.uid]&&null!==s[this.uid].value?s[this.uid].value:this.parent.max)<=t&&(t=i),t}},{key:"destroy",value:function(){this.$element.off(".asRange"),this.$element.remove()}}]),l);function l(t,e,i){a(this,l),this.$element=t,this.uid=e,this.parent=i,this.options=p.default.extend(!0,{},this.parent.options),this.direction=this.options.direction,this.value=null,this.classes={active:this.parent.namespace+"-pointer_active"}}var h,c={defaults:{scale:{valuesNumber:3,gap:1,grid:5}},init:function(t){var e=p.default.extend({},this.defaults,t.options.scale).scale;e.values=[],e.values.push(t.min);for(var i=(t.max-t.min)/(e.valuesNumber-1),s=1;s<=e.valuesNumber-2;s++)e.values.push(i*s);e.values.push(t.max);var n={scale:t.namespace+"-scale",lines:t.namespace+"-scale-lines",grid:t.namespace+"-scale-grid",inlineGrid:t.namespace+"-scale-inlineGrid",values:t.namespace+"-scale-values"},a=e.values.length,o=((e.grid-1)*(e.gap+1)+e.gap)*(a-1)+a,r=100/(o-1),u=100/(a-1);this.$scale=(0,p.default)("<div></div>").addClass(n.scale),this.$lines=(0,p.default)("<ul></ul>").addClass(n.lines),this.$values=(0,p.default)("<ul></ul>").addClass(n.values);for(var l=0;l<o;l++){(0===l||l===o||l%((o-1)/(a-1))==0?(0,p.default)('<li class="'+n.grid+'"></li>'):l%e.grid==0?(0,p.default)('<li class="'+n.inlineGrid+'"></li>'):(0,p.default)("<li></li>")).css({left:r*l+"%"}).appendTo(this.$lines)}for(var h=0;h<a;h++)(0,p.default)("<li><span>"+e.values[h]+"</span></li>").css({left:u*h+"%"}).appendTo(this.$values);this.$lines.add(this.$values).appendTo(this.$scale),this.$scale.appendTo(t.$wrap)},update:function(t){this.$scale.remove(),this.init(t)}},d={defaults:{},init:function(i){var s=this;if(this.$arrow=(0,p.default)("<span></span>").appendTo(i.$wrap),this.$arrow.addClass(i.namespace+"-selected"),!1===i.options.range&&i.p1.$element.on(i.namespace+"::move",function(t,e){s.$arrow.css({left:0,width:e.getPercent()+"%"})}),!0===i.options.range){var t=function(){var t=i.p2.getPercent()-i.p1.getPercent(),e=void 0;e=0<=t?i.p1.getPercent():(t=-t,i.p2.getPercent()),s.$arrow.css({left:e+"%",width:t+"%"})};i.p1.$element.on(i.namespace+"::move",t),i.p2.$element.on(i.namespace+"::move",t)}}},f={defaults:{active:"always"},init:function(n){var e=this,t=p.default.extend({},this.defaults,n.options.tip);this.opts=t,this.classes={tip:n.namespace+"-tip",show:n.namespace+"-tip-show"},p.default.each(n.pointer,function(i,t){var s=(0,p.default)("<span></span>").appendTo(n.pointer[i].$element);s.addClass(e.classes.tip),"onMove"===e.opts.active&&(s.css({display:"none"}),t.$element.on(n.namespace+"::moveEnd",function(){return e.hide(s),!1}).on(n.namespace+"::moveStart",function(){return e.show(s),!1})),t.$element.on(n.namespace+"::move",function(){var t=void 0;if(t=n.options.range?n.get()[i]:n.get(),"function"==typeof n.options.format)if(n.options.replaceFirst&&"number"!=typeof t){if("string"==typeof n.options.replaceFirst&&(t=n.options.replaceFirst),"object"===o(n.options.replaceFirst))for(var e in n.options.replaceFirst)Object.hasOwnProperty(n.options.replaceFirst,e)&&(t=n.options.replaceFirst[e])}else t=n.options.format(t);return s.text(t),!1})})},show:function(t){t.addClass(this.classes.show),t.css({display:"block"})},hide:function(t){t.removeClass(this.classes.show),t.css({display:"none"})}},v="asRange",m={},g=(i(y,[{key:"init",value:function(){this.$wrap.append('<div class="'+this.namespace+'-bar" />'),this.buildPointers(),this.components.selected.init(this),!1!==this.options.tip&&this.components.tip.init(this),!1!==this.options.scale&&this.components.scale.init(this),this.set(this.value),this.bindEvents(),this._trigger("ready"),this.initialized=!0}},{key:"_trigger",value:function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];var n=[this].concat(i);this.$element.trigger(v+"::"+t,n);var a="on"+(t=t.replace(/\b\w+\b/g,function(t){return t.substring(0,1).toUpperCase()+t.substring(1)}));"function"==typeof this.options[a]&&this.options[a].apply(this,i)}},{key:"buildPointers",value:function(){this.pointer=[];var t=1;this.options.range&&(t=2);for(var e=1;e<=t;e++){var i=(0,p.default)('<div class="'+this.namespace+"-pointer "+this.namespace+"-pointer-"+e+'"></div>').appendTo(this.$wrap),s=new n(i,e,this);this.pointer.push(s)}this.p1=this.pointer[0],this.options.range&&(this.p2=this.pointer[1])}},{key:"bindEvents",value:function(){var e=this,s=this;this.$wrap.on("touchstart.asRange mousedown.asRange",function(t){if(!0!==s.disabled){if((t=u(t)).which?3===t.which:2===t.button)return!1;var e=s.$wrap.offset(),i=t[s.direction.axis]-e[s.direction.position];return s.getAdjacentPointer(i).mousedown(t),!1}}),this.$element.is("input")&&this.$element.on(v+"::change",function(){var t=e.get();e.$element.val(t)}),p.default.each(this.pointer,function(t,e){e.$element.on(v+"::move",function(){return s.value=s.get(),!s.initialized||s.updating||s._trigger("change",s.value),!1})})}},{key:"getValueFromPosition",value:function(t){return 0<t?this.min+t/this.getLength()*this.interval:0}},{key:"getAdjacentPointer",value:function(t){var e=this.getValueFromPosition(t);if(this.options.range){var i=this.p1.value,s=this.p2.value,n=Math.abs(i-s);return i<=s?i+n/2<e?this.p2:this.p1:s+n/2<e?this.p1:this.p2}return this.p1}},{key:"getLength",value:function(){return"v"===this.options.direction?this.$wrap.height():this.$wrap.width()}},{key:"update",value:function(i){var s=this;this.updating=!0,p.default.each(["max","min","step","limit","value"],function(t,e){i[e]&&(s[e]=i[e])}),(i.max||i.min)&&this.setInterval(i.min,i.max),i.value||(this.value=i.min),p.default.each(this.components,function(t,e){"function"==typeof e.update&&e.update(s)}),this.set(this.value),this._trigger("update"),this.updating=!1}},{key:"get",value:function(){var i=[];if(p.default.each(this.pointer,function(t,e){i[t]=e.get()}),this.options.range)return i;if(i[0]===this.options.min&&("string"==typeof this.options.replaceFirst&&(i[0]=this.options.replaceFirst),"object"===o(this.options.replaceFirst)))for(var t in this.options.replaceFirst)Object.hasOwnProperty(this.options.replaceFirst,t)&&(i[0]=t);return i[0]}},{key:"set",value:function(i){if(this.options.range){if("number"==typeof i&&(i=[i]),!p.default.isArray(i))return;p.default.each(this.pointer,function(t,e){e.set(i[t])})}else this.p1.set(i);this.value=i}},{key:"val",value:function(t){return t?(this.set(t),this):this.get()}},{key:"setInterval",value:function(t,e){this.min=t,this.max=e,this.interval=e-t}},{key:"enable",value:function(){return this.disabled=!1,this.$wrap.removeClass(this.namespace+"_disabled"),this._trigger("enable"),this}},{key:"disable",value:function(){return this.disabled=!0,this.$wrap.addClass(this.namespace+"_disabled"),this._trigger("disable"),this}},{key:"destroy",value:function(){p.default.each(this.pointer,function(t,e){e.destroy()}),this.$wrap.destroy(),this._trigger("destroy")}}],[{key:"registerComponent",value:function(t,e){m[t]=e}},{key:"setDefaults",value:function(t){p.default.extend(r,p.default.isPlainObject(t)&&t)}}]),y);function y(t,e){var s=this;a(this,y);var n={};if(this.element=t,this.$element=(0,p.default)(t),this.$element.is("input")){var i=this.$element.val();"string"==typeof i&&(n.value=i.split(",")),p.default.each(["min","max","step"],function(t,e){var i=parseFloat(s.$element.attr(e));isNaN(i)||(n[e]=i)}),this.$element.css({display:"none"}),this.$wrap=(0,p.default)("<div></div>"),this.$element.after(this.$wrap)}else this.$wrap=this.$element;if(this.options=p.default.extend({},r,e,this.$element.data(),n),this.namespace=this.options.namespace,this.components=p.default.extend(!0,{},m),this.options.range&&(this.options.replaceFirst=!1),this.value=this.options.value,null===this.value&&(this.value=this.options.min),this.options.range?p.default.isArray(this.value)?1===this.value.length&&(this.value[1]=this.value[0]):this.value=[this.value,this.value]:p.default.isArray(this.value)&&(this.value=this.value[0]),this.min=this.options.min,this.max=this.options.max,this.step=this.options.step,this.interval=this.max-this.min,this.initialized=!1,this.updating=!1,this.disabled=!1,"v"===this.options.direction?this.direction={axis:"pageY",position:"top"}:this.direction={axis:"pageX",position:"left"},this.$wrap.addClass(this.namespace),this.options.skin&&this.$wrap.addClass(this.namespace+"_"+this.options.skin),this.max<this.min||this.step>=this.interval)throw new Error("error options about max min step");this.init()}g.registerComponent("scale",c),g.registerComponent("selected",d),g.registerComponent("tip",f),(h=(0,p.default)(document)).on("asRange::ready",function(t,n){var a=void 0,o={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;if(e in o.map&&"function"==typeof o.map[e])return o.map[e](t),!1},attach:function(t){var e=void 0,i=void 0;for(e in t)t.hasOwnProperty(e)&&((i=e.toUpperCase())in o.keys?o.map[o.keys[i]]=t[e]:o.map[i]=t[e]);o.bound||(o.bound=!0,h.bind("keydown",o.press))},detach:function(){o.bound=!1,o.map={},h.unbind("keydown",o.press)}};!0===n.options.keyboard&&p.default.each(n.pointer,function(t,e){a=n.options.step?n.options.step:1;function i(){var t=e.value;e.set(t-a)}function s(){var t=e.value;e.set(t+a)}e.$element.attr("tabindex","0").on("focus",function(){return o.attach({left:i,right:s}),!1}).on("blur",function(){return o.detach(),!1})})});function $(i){for(var s=this,t=arguments.length,n=Array(1<t?t-1:0),e=1;e<t;e++)n[e-1]=arguments[e];if("string"==typeof i){var a=function(){var e=i;if(/^_/.test(e))return{v:!1};if(!(/^(get)$/.test(e)||"val"===e&&0===n.length))return{v:s.each(function(){var t=p.default.data(this,b);t&&"function"==typeof t[e]&&t[e].apply(t,n)})};var t=s.first().data(b);return t&&"function"==typeof t[e]?{v:t[e].apply(t,n)}:void 0}();if("object"===(void 0===a?"undefined":o(a)))return a.v}return this.each(function(){(0,p.default)(this).data(b)||(0,p.default)(this).data(b,new g(this,i))})}var b="asRange",w=p.default.fn.asRange;p.default.fn.asRange=$,p.default.asRange=p.default.extend({setDefaults:g.setDefaults,noConflict:function(){return p.default.fn.asRange=w,$}},{version:"0.3.2"})});